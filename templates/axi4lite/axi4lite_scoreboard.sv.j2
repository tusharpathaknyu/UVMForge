//------------------------------------------------------------------------------
// AXI4-Lite Scoreboard - Generated by VerifAI
//------------------------------------------------------------------------------

class {{ prefix }}_scoreboard extends uvm_scoreboard;
    `uvm_component_utils({{ prefix }}_scoreboard)
    
    uvm_analysis_imp #({{ prefix }}_seq_item, {{ prefix }}_scoreboard) ap;
    bit [{{ data_width }}-1:0] reg_model[bit [{{ addr_width }}-1:0]];
    
    int num_writes, num_reads, num_errors, num_matches;
    
    function new(string name = "{{ prefix }}_scoreboard", uvm_component parent = null);
        super.new(name, parent);
        ap = new("ap", this);
    endfunction
    
    virtual function void build_phase(uvm_phase phase);
        super.build_phase(phase);
{% for reg in registers %}
        reg_model[{{ reg.address_hex }}] = {{ reg.reset_value_hex }};
{% endfor %}
    endfunction
    
    virtual function void write({{ prefix }}_seq_item txn);
        if (txn.trans_type == AXI_WRITE) begin
            num_writes++;
            if (is_writable(txn.addr))
                reg_model[txn.addr] = txn.data;
        end else begin
            num_reads++;
            if (reg_model.exists(txn.addr)) begin
                if (txn.rdata === reg_model[txn.addr]) begin
                    num_matches++;
                end else begin
                    num_errors++;
                    `uvm_error(get_type_name(), $sformatf("MISMATCH @ 0x%0h: exp=0x%0h got=0x%0h",
                        txn.addr, reg_model[txn.addr], txn.rdata))
                end
            end
        end
    endfunction
    
    virtual function bit is_writable(bit [{{ addr_width }}-1:0] addr);
        case (addr)
{% for reg in registers %}
{% if reg.is_writable %}
            {{ reg.address_hex }}: return 1;
{% else %}
            {{ reg.address_hex }}: return 0;
{% endif %}
{% endfor %}
            default: return 1;
        endcase
    endfunction
    
    virtual function void report_phase(uvm_phase phase);
        `uvm_info(get_type_name(), "===== SCOREBOARD SUMMARY =====", UVM_NONE)
        `uvm_info(get_type_name(), $sformatf("Writes: %0d, Reads: %0d", num_writes, num_reads), UVM_NONE)
        `uvm_info(get_type_name(), $sformatf("Matches: %0d, Errors: %0d", num_matches, num_errors), UVM_NONE)
        if (num_errors > 0)
            `uvm_error(get_type_name(), "TEST FAILED")
        else
            `uvm_info(get_type_name(), "TEST PASSED", UVM_NONE)
    endfunction
endclass : {{ prefix }}_scoreboard
